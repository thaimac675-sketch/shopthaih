<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8"><title>N·∫°p Th·∫ª - THAIPP</title>
    <style>
        body { font-family: sans-serif; background: #f1f5f9; padding: 15px; }
        .box { background: white; padding: 20px; border-radius: 15px; max-width: 400px; margin: auto; }
        input, select { width: 100%; padding: 12px; margin: 10px 0; border: 1px solid #ddd; border-radius: 8px; box-sizing: border-box; }
        .btn { width: 100%; padding: 12px; background: #e11d48; color: white; border: none; border-radius: 8px; font-weight: bold; cursor: pointer; }
        .history { margin-top: 20px; font-size: 13px; }
        .status-0 { color: orange; } /* Ch·ªù duy·ªát */
        .status-1 { color: green; font-weight: bold; } /* Th√†nh c√¥ng */
        .status-2 { color: red; } /* Th·∫•t b·∫°i */
    </style>
</head>
<body>
    <div class="box">
        <h2>üí≥ N·∫†P TH·∫∫ C√ÄO</h2>
        <select id="telco">
            <option value="VIETTEL">Viettel</option>
            <option value="VINAPHONE">Vinaphone</option>
            <option value="MOBIFONE">Mobifone</option>
        </select>
        <input type="number" id="serial" placeholder="S·ªë Serial">
        <input type="number" id="pin" placeholder="M√£ th·∫ª">
        <select id="amount">
            <option value="10000">10,000ƒë</option>
            <option value="50000">50,000ƒë</option>
            <option value="100000">100,000ƒë</option>
            <option value="500000">500,000ƒë</option>
        </select>
        <button class="btn" onclick="sendCard()">G·ª¨I TH·∫∫ NGAY</button>

        <div class="history">
            <h3>üìú L·ªäCH S·ª¨ N·∫†P</h3>
            <div id="log-n·∫°p"></div>
        </div>
        <p style="text-align:center"><a href="index.html">Quay l·∫°i</a></p>
    </div>

    <script>
        const user = localStorage.getItem("currentUser");
        function sendCard() {
            if(!user) return alert("H√£y ƒëƒÉng nh·∫≠p!");
            const card = {
                id: Date.now(),
                user: user,
                telco: document.getElementById('telco').value,
                serial: document.getElementById('serial').value,
                pin: document.getElementById('pin').value,
                amount: document.getElementById('amount').value,
                status: 0, // 0: Ch·ªù x·ª≠ l√Ω, 1: Th√†nh c√¥ng, 2: Th·∫•t b·∫°i
                time: new Date().toLocaleString()
            };
            if(!card.serial || !card.pin) return alert("Nh·∫≠p ƒë·ªß th√¥ng tin!");

            let pending = JSON.parse(localStorage.getItem("all_cards") || "[]");
            pending.push(card);
            localStorage.setItem("all_cards", JSON.stringify(pending));
            alert("G·ª≠i th·∫ª th√†nh c√¥ng! Vui l√≤ng ch·ªù Admin duy·ªát.");
            location.reload();
        }

        function showHistory() {
            const all = JSON.parse(localStorage.getItem("all_cards") || "[]");
            const mine = all.filter(c => c.user === user);
            const container = document.getElementById("log-n·∫°p");
            mine.reverse().forEach(c => {
                let st = c.status == 0 ? '<span class="status-0">Ch·ªù x·ª≠ l√Ω</span>' : 
                         c.status == 1 ? '<span class="status-1">Th√†nh c√¥ng</span>' : 
                                         '<span class="status-2">Th·∫•t b·∫°i (Sai th·∫ª)</span>';
                container.innerHTML += `<div style="border-bottom:1px solid #eee; padding:5px;">
                    ${c.time} - <b>${parseInt(c.amount).toLocaleString()}ƒë</b><br>Tr·∫°ng th√°i: ${st}
                </div>`;
            });
        }
        window.onload = showHistory;
    </script>
</body>
    </html>
